### Starting server for test 
97596:M 03 May 2025 23:05:32.146 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
97596:M 03 May 2025 23:05:32.152 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
97596:M 03 May 2025 23:05:32.153 * Valkey version=255.255.255, bits=64, commit=06ac4d81, modified=0, pid=97596, just started
97596:M 03 May 2025 23:05:32.156 * Configuration loaded
97596:M 03 May 2025 23:05:32.159 * Increased maximum number of open files to 10032 (it was originally set to 256).
97596:M 03 May 2025 23:05:32.162 * monotonic clock: POSIX clock_gettime
97596:M 03 May 2025 23:05:32.163 # Failed to write PID file: Permission denied
                .+^+.                                                
            .+#########+.                                            
        .+########+########+.           Valkey 255.255.255 (06ac4d81/0) 64 bit
    .+########+'     '+########+.                                    
 .########+'     .+.     '+########.    Running in cluster mode
 |####+'     .+#######+.     '+####|    Port: 23643
 |###|   .+###############+.   |###|    PID: 97596                     
 |###|   |#####*'' ''*#####|   |###|                                 
 |###|   |####'  .-.  '####|   |###|                                 
 |###|   |###(  (@@@)  )###|   |###|          https://valkey.io      
 |###|   |####.  '-'  .####|   |###|                                 
 |###|   |#####*.   .*#####|   |###|                                 
 |###|   '+#####|   |#####+'   |###|                                 
 |####+.     +##|   |#+'     .+####|                                 
 '#######+   |##|        .+########'                                 
    '+###|   |##|    .+########+'                                    
        '|   |####+########+'                                        
             +#########+'                                            
                '+v+'                                                

97596:M 03 May 2025 23:05:32.163 # WARNING: The TCP backlog setting of 511 cannot be enforced because kern.ipc.somaxconn is set to the lower value of 128.
97596:M 03 May 2025 23:05:32.163 * No cluster configuration found, I'm a795b8f0589ac8c7b5c472c486308cddcef559e2
97596:M 03 May 2025 23:05:32.175 * Server initialized
97596:M 03 May 2025 23:05:32.175 * Ready to accept connections tcp
97596:M 03 May 2025 23:05:32.175 * Ready to accept connections unix
97596:M 03 May 2025 23:05:32.300 - Accepted 127.0.0.1:56452
97596:M 03 May 2025 23:05:32.301 - Client closed connection id=2 addr=127.0.0.1:56452 laddr=127.0.0.1:23643 fd=14 name= age=0 idle=0 flags=N capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=16384 rbp=16384 obl=0 oll=0 omem=0 tot-mem=33792 events=r cmd=ping user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=7 tot-net-out=7 tot-cmds=1
97596:M 03 May 2025 23:05:32.322 - Accepted 127.0.0.1:56453
97596:M 03 May 2025 23:05:33.056 - Accepting cluster node connection from 127.0.0.1:56538
97596:M 03 May 2025 23:05:33.056 * IP address for this node updated to 127.0.0.1
97596:M 03 May 2025 23:05:33.200 - Accepting cluster node connection from 127.0.0.1:56547
97596:M 03 May 2025 23:05:33.200 - Accepting cluster node connection from 127.0.0.1:56552
97596:M 03 May 2025 23:05:33.201 - Accepting cluster node connection from 127.0.0.1:56554
97596:M 03 May 2025 23:05:33.204 * configEpoch collision with node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 (). configEpoch set to 2
97596:M 03 May 2025 23:05:33.253 - Accepting cluster node connection from 127.0.0.1:56561
97596:M 03 May 2025 23:05:33.268 * configEpoch collision with node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 (). configEpoch set to 3
97596:M 03 May 2025 23:05:33.341 - Handshake: we already know node 3a46d596d455d018bea8fe52c1d42bef982fb9eb (), updating the address if needed.
97596:M 03 May 2025 23:05:33.394 - Accepting cluster node connection from 127.0.0.1:56569
97596:M 03 May 2025 23:05:33.438 # Missing implement of connection type tls
97596:S 03 May 2025 23:05:33.462 * Connecting to PRIMARY 127.0.0.1:23646
97596:S 03 May 2025 23:05:33.464 * PRIMARY <-> REPLICA sync started
97596:S 03 May 2025 23:05:33.464 * Cluster state changed: ok
97596:S 03 May 2025 23:05:33.465 * Non blocking connect for SYNC fired the event.
97596:S 03 May 2025 23:05:33.465 * Primary replied to PING, replication can continue...
97596:S 03 May 2025 23:05:33.465 * Partial resynchronization not possible (no cached primary)
97596:S 03 May 2025 23:05:33.465 * Full resync from primary: b69b009e79cfac3101754b1db14b6997ae3a110f:0
97596:S 03 May 2025 23:05:33.467 * Node f09602eab915d134ec3fa21f82d6b91a2a0af831 () is no longer primary of shard 1527c0999fcdfd6371d2da9642bf2fec41b5b54e; removed all 0 slot(s) it used to own
97596:S 03 May 2025 23:05:33.467 * Node f09602eab915d134ec3fa21f82d6b91a2a0af831 () is now part of shard 19a99c7ea6d919e3e6462f6d76e99c382661c7e3
97596:S 03 May 2025 23:05:33.467 * Node f09602eab915d134ec3fa21f82d6b91a2a0af831 () is now a replica of node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 () in shard 19a99c7ea6d919e3e6462f6d76e99c382661c7e3
97596:S 03 May 2025 23:05:33.467 * PRIMARY <-> REPLICA sync: receiving streamed RDB from primary with EOF to disk
97596:S 03 May 2025 23:05:33.467 * Node 3a46d596d455d018bea8fe52c1d42bef982fb9eb () is no longer primary of shard 83954a76e2c9bbbbe788a93cc217f7492d835402; removed all 0 slot(s) it used to own
97596:S 03 May 2025 23:05:33.467 * Node 3a46d596d455d018bea8fe52c1d42bef982fb9eb () is now part of shard d1ef25a6da5c60f4770029e2a0899cda94efc970
97596:S 03 May 2025 23:05:33.467 * Node 3a46d596d455d018bea8fe52c1d42bef982fb9eb () is now a replica of node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 () in shard d1ef25a6da5c60f4770029e2a0899cda94efc970
97596:S 03 May 2025 23:05:33.470 * PRIMARY <-> REPLICA sync: Flushing old data
97596:S 03 May 2025 23:05:33.470 * PRIMARY <-> REPLICA sync: Loading DB in memory
97596:S 03 May 2025 23:05:33.471 * Loading RDB produced by Valkey version 255.255.255
97596:S 03 May 2025 23:05:33.471 * RDB age 0 seconds
97596:S 03 May 2025 23:05:33.471 * RDB memory usage when created 2.91 Mb
97596:S 03 May 2025 23:05:33.471 * Done loading RDB, keys loaded: 0, keys expired: 0.
97596:S 03 May 2025 23:05:33.471 * PRIMARY <-> REPLICA sync: Finished with success
97596:S 03 May 2025 23:05:33.471 # DEBUG LOG: ========== I am replica 3 ==========
### Starting test Cluster should start ok in tests/unit/cluster/cluster-shards.tcl
### Starting test Cluster shards response is ok for shard 0 in tests/unit/cluster/cluster-shards.tcl
### Starting test Kill a node and tell the replica to immediately takeover in tests/unit/cluster/cluster-shards.tcl
97596:S 03 May 2025 23:05:43.247 * Forced failover user request accepted (user request from 'id=3 addr=127.0.0.1:56453 laddr=127.0.0.1:23643 fd=14 name= user=default lib-name= lib-ver=').
97596:S 03 May 2025 23:05:43.248 * Start of election delayed for 0 milliseconds (rank #0, primary rank #0, offset 14).
97596:S 03 May 2025 23:05:43.248 * Starting a failover election for epoch 6, node config epoch is 1
### Starting test Verify health as fail for killed node in tests/unit/cluster/cluster-shards.tcl
97596:S 03 May 2025 23:05:43.288 * Currently unable to failover: Waiting for votes, but majority still not reached.
97596:S 03 May 2025 23:05:43.288 * Needed quorum: 2. Number of votes received so far: 1
97596:S 03 May 2025 23:05:43.289 * Failover election won: I'm the new primary.
97596:S 03 May 2025 23:05:43.296 * configEpoch set to 6 after successful failover
97596:S 03 May 2025 23:05:43.299 * Setting myself to primary in shard bfad5b862255f833dbea7e6cbd29f333394f2e85 after failover; my old primary is 25e47028901afc1b98565f7d3a8f285acc4825ec ()
97596:M 03 May 2025 23:05:43.301 * Connection with primary lost.
97596:M 03 May 2025 23:05:43.303 * Caching the disconnected primary state.
97596:M 03 May 2025 23:05:43.305 * Discarding previously cached primary state.
97596:M 03 May 2025 23:05:43.307 * Setting secondary replication ID to b69b009e79cfac3101754b1db14b6997ae3a110f, valid up to offset: 15. New replication ID is a89ff91d6db78914d2bab47b3857585c4e768c8a
97596:M 03 May 2025 23:05:46.381 * Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 () reported node 25e47028901afc1b98565f7d3a8f285acc4825ec () as not reachable.
97596:M 03 May 2025 23:05:46.404 * FAIL message received from ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 () about 25e47028901afc1b98565f7d3a8f285acc4825ec ()
### Starting test CLUSTER SHARDS slot response is non-empty when primary node fails in tests/unit/cluster/cluster-shards.tcl
97596:M 03 May 2025 23:05:46.444 * Node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 () reported node 25e47028901afc1b98565f7d3a8f285acc4825ec () as not reachable.
### Starting test Check for memory leaks (pid 97672) in tests/unit/cluster/cluster-shards.tcl
97596:M 03 May 2025 23:05:47.626 - Accepted 127.0.0.1:58435
97596:M 03 May 2025 23:05:47.630 * A failover occurred in shard bfad5b862255f833dbea7e6cbd29f333394f2e85; node 25e47028901afc1b98565f7d3a8f285acc4825ec () failed over to node a795b8f0589ac8c7b5c472c486308cddcef559e2 () with a config epoch of 6
97596:M 03 May 2025 23:05:47.630 * Node 25e47028901afc1b98565f7d3a8f285acc4825ec () is now a replica of node a795b8f0589ac8c7b5c472c486308cddcef559e2 () in shard bfad5b862255f833dbea7e6cbd29f333394f2e85
97596:M 03 May 2025 23:05:47.631 * Clear FAIL state for node 25e47028901afc1b98565f7d3a8f285acc4825ec (): replica is reachable again.
97596:M 03 May 2025 23:05:47.631 * Replica 127.0.0.1:23646 asks for synchronization
97596:M 03 May 2025 23:05:47.631 * Partial resynchronization request from 127.0.0.1:23646 accepted. Sending 0 bytes of backlog starting from offset 15.
97596:M 03 May 2025 23:05:47.662 * Node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 () reported node 25e47028901afc1b98565f7d3a8f285acc4825ec () is back online.
97596:M 03 May 2025 23:05:47.746 - Client closed connection id=7 addr=127.0.0.1:58435 laddr=127.0.0.1:23643 fd=25 name= age=0 idle=0 flags=S capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=16384 rbp=0 obl=0 oll=1 omem=16920 tot-mem=50712 events=r cmd=psync user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=333 tot-net-out=27 tot-cmds=6
97596:M 03 May 2025 23:05:47.746 * Connection with replica 127.0.0.1:23646 lost.
97596:M 03 May 2025 23:05:47.758 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
### Starting test Check for memory leaks (pid 97660) in tests/unit/cluster/cluster-shards.tcl
97596:M 03 May 2025 23:05:47.859 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:47.960 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.061 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.161 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.262 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.363 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.464 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.565 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.666 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.767 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.867 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:48.880 * Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 () reported node 25e47028901afc1b98565f7d3a8f285acc4825ec () is back online.
97596:M 03 May 2025 23:05:48.968 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.070 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.070 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
### Starting test Check for memory leaks (pid 97631) in tests/unit/cluster/cluster-shards.tcl
97596:M 03 May 2025 23:05:49.170 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.176 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.273 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.274 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.371 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.371 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.472 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.475 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.573 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.573 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.675 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.678 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.776 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.779 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.877 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.879 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:49.979 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:49.984 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.080 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.087 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.180 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.185 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.281 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.285 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.381 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.382 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.482 - Connection with Node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 at 127.0.0.1:33644 failed: Connection refused
97596:M 03 May 2025 23:05:50.482 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.488 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.526 - Client closed connection id=3 addr=127.0.0.1:56453 laddr=127.0.0.1:23643 fd=14 name= age=18 idle=7 flags=N capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=1024 rbp=0 obl=0 oll=0 omem=0 tot-mem=18432 events=r cmd=cluster|failover user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=356 tot-net-out=4748 tot-cmds=9
97596:M 03 May 2025 23:05:50.583 - Connection with Node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 at 127.0.0.1:33644 failed: Connection refused
97596:M 03 May 2025 23:05:50.584 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.587 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.684 - Connection with Node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 at 127.0.0.1:33644 failed: Connection refused
97596:M 03 May 2025 23:05:50.687 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.691 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:50.784 - Connection with Node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 at 127.0.0.1:33644 failed: Connection refused
97596:M 03 May 2025 23:05:50.794 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:50.798 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:M 03 May 2025 23:05:51.622 - Connection with Node ed6aff43eddaa909e23d1006a8cc698b4c2cfe12 at 127.0.0.1:33644 failed: Connection refused
97596:M 03 May 2025 23:05:51.626 - Connection with Node bebae9aa492eeccd2ccc10ca8cb192bb03d863a8 at 127.0.0.1:33645 failed: Connection refused
97596:M 03 May 2025 23:05:51.632 - Connection with Node 25e47028901afc1b98565f7d3a8f285acc4825ec at 127.0.0.1:33646 failed: Connection refused
97596:signal-handler (1746281151) Received SIGTERM scheduling shutdown...
97596:M 03 May 2025 23:05:51.723 * User requested shutdown...
97596:M 03 May 2025 23:05:51.723 * Removing the pid file.
97596:M 03 May 2025 23:05:51.723 * Saving the cluster configuration file before exiting.
97596:M 03 May 2025 23:05:51.730 * Removing the unix socket file.
97596:M 03 May 2025 23:05:51.736 # Valkey is now ready to exit, bye bye...

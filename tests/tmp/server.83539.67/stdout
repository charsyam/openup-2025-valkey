### Starting server for test 
345:M 03 May 2025 23:06:02.967 # WARNING: Changing databases number from 16 to 1 since we are in cluster mode
345:M 03 May 2025 23:06:02.968 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
345:M 03 May 2025 23:06:02.970 * Valkey version=255.255.255, bits=64, commit=06ac4d81, modified=0, pid=345, just started
345:M 03 May 2025 23:06:02.970 * Configuration loaded
345:M 03 May 2025 23:06:02.974 * Increased maximum number of open files to 10032 (it was originally set to 256).
345:M 03 May 2025 23:06:02.976 * monotonic clock: POSIX clock_gettime
345:M 03 May 2025 23:06:02.982 # Failed to write PID file: Permission denied
                .+^+.                                                
            .+#########+.                                            
        .+########+########+.           Valkey 255.255.255 (06ac4d81/0) 64 bit
    .+########+'     '+########+.                                    
 .########+'     .+.     '+########.    Running in cluster mode
 |####+'     .+#######+.     '+####|    Port: 28144
 |###|   .+###############+.   |###|    PID: 345                     
 |###|   |#####*'' ''*#####|   |###|                                 
 |###|   |####'  .-.  '####|   |###|                                 
 |###|   |###(  (@@@)  )###|   |###|          https://valkey.io      
 |###|   |####.  '-'  .####|   |###|                                 
 |###|   |#####*.   .*#####|   |###|                                 
 |###|   '+#####|   |#####+'   |###|                                 
 |####+.     +##|   |#+'     .+####|                                 
 '#######+   |##|        .+########'                                 
    '+###|   |##|    .+########+'                                    
        '|   |####+########+'                                        
             +#########+'                                            
                '+v+'                                                

345:M 03 May 2025 23:06:02.982 # WARNING: The TCP backlog setting of 511 cannot be enforced because kern.ipc.somaxconn is set to the lower value of 128.
345:M 03 May 2025 23:06:02.983 * No cluster configuration found, I'm 3f1fe177229b170047ebdd7c3cc22b813c6e2e16
345:M 03 May 2025 23:06:02.999 * Server initialized
345:M 03 May 2025 23:06:02.999 * Ready to accept connections tcp
345:M 03 May 2025 23:06:02.999 * Ready to accept connections unix
345:M 03 May 2025 23:06:03.136 - Accepted 127.0.0.1:65165
345:M 03 May 2025 23:06:03.138 - Client closed connection id=2 addr=127.0.0.1:65165 laddr=127.0.0.1:28144 fd=14 name= age=0 idle=0 flags=N capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=16384 rbp=16384 obl=0 oll=0 omem=0 tot-mem=33792 events=r cmd=ping user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=7 tot-net-out=7 tot-cmds=1
345:M 03 May 2025 23:06:03.161 - Accepted 127.0.0.1:65197
345:M 03 May 2025 23:06:04.641 - Accepting cluster node connection from 127.0.0.1:49521
345:M 03 May 2025 23:06:04.654 * IP address for this node updated to 127.0.0.1
345:M 03 May 2025 23:06:04.780 * configEpoch collision with node b9974d611bfa3d3de4616b5482400caaa6e55244 (). configEpoch set to 1
345:M 03 May 2025 23:06:04.797 * configEpoch collision with node b9974d611bfa3d3de4616b5482400caaa6e55244 (). configEpoch set to 2
345:M 03 May 2025 23:06:04.824 - Accepting cluster node connection from 127.0.0.1:49620
345:M 03 May 2025 23:06:04.864 - Accepting cluster node connection from 127.0.0.1:49634
345:M 03 May 2025 23:06:04.864 - Accepting cluster node connection from 127.0.0.1:49656
345:M 03 May 2025 23:06:04.871 - Accepting cluster node connection from 127.0.0.1:49665
345:M 03 May 2025 23:06:04.872 * Successfully completed handshake with d97d9d928ed6758a1efafa02264c9cb65b7c5b32 ()
345:M 03 May 2025 23:06:04.962 * configEpoch collision with node 533e5120edb4cd496476e9bf99940fed1936245a (). configEpoch set to 5
345:M 03 May 2025 23:06:04.996 - Accepting cluster node connection from 127.0.0.1:49730
345:M 03 May 2025 23:06:05.069 * Cluster state changed: ok
345:M 03 May 2025 23:06:05.150 # Missing implement of connection type tls
345:M 03 May 2025 23:06:05.155 * Node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () is no longer primary of shard c29b012cead6693099a277ae7f36be75e3466a93; removed all 0 slot(s) it used to own
345:M 03 May 2025 23:06:05.155 * Node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () is now part of shard 8b4aef7e44a56d7e7bc3679c4687aed086bec4ce
345:M 03 May 2025 23:06:05.155 * Node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () is now a replica of node b9974d611bfa3d3de4616b5482400caaa6e55244 () in shard 8b4aef7e44a56d7e7bc3679c4687aed086bec4ce
345:S 03 May 2025 23:06:05.155 * Connecting to PRIMARY 127.0.0.1:28150
345:S 03 May 2025 23:06:05.155 * PRIMARY <-> REPLICA sync started
345:S 03 May 2025 23:06:05.156 * Non blocking connect for SYNC fired the event.
345:S 03 May 2025 23:06:05.160 * Primary replied to PING, replication can continue...
345:S 03 May 2025 23:06:05.160 * Partial resynchronization not possible (no cached primary)
345:S 03 May 2025 23:06:05.161 * Node 533e5120edb4cd496476e9bf99940fed1936245a () is no longer primary of shard 7f8645519beaeead9a6a02cc3a9863c0a08d398d; removed all 0 slot(s) it used to own
345:S 03 May 2025 23:06:05.161 * Node 533e5120edb4cd496476e9bf99940fed1936245a () is now part of shard bdccee44b1abd16142888ef39545125f1bc54c41
345:S 03 May 2025 23:06:05.161 * Node 533e5120edb4cd496476e9bf99940fed1936245a () is now a replica of node 6ae1e1ab85f709a568344deaee675da0b6089aef () in shard bdccee44b1abd16142888ef39545125f1bc54c41
345:S 03 May 2025 23:06:05.165 * Full resync from primary: 22bead19d5d4bd2b0bdd01f10626465737bafb1e:0
345:S 03 May 2025 23:06:05.167 * PRIMARY <-> REPLICA sync: receiving streamed RDB from primary with EOF to disk
345:S 03 May 2025 23:06:05.173 * PRIMARY <-> REPLICA sync: Flushing old data
345:S 03 May 2025 23:06:05.173 * PRIMARY <-> REPLICA sync: Loading DB in memory
345:S 03 May 2025 23:06:05.173 * Loading RDB produced by Valkey version 255.255.255
345:S 03 May 2025 23:06:05.174 * RDB age 0 seconds
345:S 03 May 2025 23:06:05.174 * RDB memory usage when created 2.97 Mb
345:S 03 May 2025 23:06:05.174 * Done loading RDB, keys loaded: 0, keys expired: 0.
345:S 03 May 2025 23:06:05.174 * PRIMARY <-> REPLICA sync: Finished with success
345:S 03 May 2025 23:06:05.174 * Node e6ff4b404c3b84e02ac7546b7d29b51c59279a3c () is no longer primary of shard 94e23a5abd2034a300d0ac36bda1eda627ea4749; removed all 0 slot(s) it used to own
345:S 03 May 2025 23:06:05.178 * Node e6ff4b404c3b84e02ac7546b7d29b51c59279a3c () is now part of shard 7e2c5896a9e894197bb68976580d8bba063b597b
345:S 03 May 2025 23:06:05.178 * Node e6ff4b404c3b84e02ac7546b7d29b51c59279a3c () is now a replica of node d97d9d928ed6758a1efafa02264c9cb65b7c5b32 () in shard 7e2c5896a9e894197bb68976580d8bba063b597b
345:S 03 May 2025 23:06:05.222 # DEBUG LOG: ========== I am replica 6 ==========
### Starting test auto-failover-on-shutdown hands over primaryship to a fully sync'd replica - shutdown - shutdown-timeout: 10 in tests/unit/cluster/auto-failover-on-shutdown.tcl
345:S 03 May 2025 23:06:17.904 * NODE 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () possibly failing.
345:S 03 May 2025 23:06:18.040 * Node b9974d611bfa3d3de4616b5482400caaa6e55244 () reported node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () as not reachable.
345:S 03 May 2025 23:06:18.041 * FAIL message received from 6ae1e1ab85f709a568344deaee675da0b6089aef () about 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 ()
345:S 03 May 2025 23:06:18.141 * Node d97d9d928ed6758a1efafa02264c9cb65b7c5b32 () reported node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () as not reachable.
345:S 03 May 2025 23:06:18.206 - DB 0: 1 keys (0 volatile) in 7 slots HT.
345:S 03 May 2025 23:06:18.207 * Node 6ae1e1ab85f709a568344deaee675da0b6089aef () reported node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () as not reachable.
345:S 03 May 2025 23:06:23.257 - DB 0: 1 keys (0 volatile) in 7 slots HT.
345:S 03 May 2025 23:06:24.902 * Forced failover primary request accepted (primary request from 'id=5 addr=127.0.0.1:28150 laddr=127.0.0.1:49821 fd=27 name= user=(superuser) lib-name= lib-ver=').
345:S 03 May 2025 23:06:24.903 * Start of election delayed for 0 milliseconds (rank #0, primary rank #0, offset 488).
345:S 03 May 2025 23:06:24.903 * Starting a failover election for epoch 7, node config epoch is 1
345:S 03 May 2025 23:06:24.913 - Client closed connection id=5 addr=127.0.0.1:28150 laddr=127.0.0.1:49821 fd=27 name= age=19 idle=0 flags=M capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=65530 argv-mem=0 multi-mem=0 rbs=1024 rbp=36 obl=0 oll=0 omem=0 tot-mem=67072 events=r cmd=cluster|failover user=(superuser) redir=-1 resp=2 lib-name= lib-ver= tot-net-in=488 tot-net-out=736 tot-cmds=14
345:S 03 May 2025 23:06:24.916 * Connection with primary lost.
345:S 03 May 2025 23:06:24.919 * Caching the disconnected primary state.
345:S 03 May 2025 23:06:24.919 * Reconnecting to PRIMARY 127.0.0.1:28150
345:S 03 May 2025 23:06:24.920 * PRIMARY <-> REPLICA sync started
345:S 03 May 2025 23:06:24.921 # Error condition on socket for SYNC: Connection refused
345:S 03 May 2025 23:06:24.921 * Failover election won: I'm the new primary.
345:S 03 May 2025 23:06:24.921 * configEpoch set to 7 after successful failover
345:S 03 May 2025 23:06:24.921 * Setting myself to primary in shard 8b4aef7e44a56d7e7bc3679c4687aed086bec4ce after failover; my old primary is b9974d611bfa3d3de4616b5482400caaa6e55244 ()
345:M 03 May 2025 23:06:24.921 * Discarding previously cached primary state.
345:M 03 May 2025 23:06:24.921 * Setting secondary replication ID to 22bead19d5d4bd2b0bdd01f10626465737bafb1e, valid up to offset: 489. New replication ID is 7a9ade1af8a31cd6f30b40be369630ffb10e5fb1
345:M 03 May 2025 23:06:24.979 - Connection with Node b9974d611bfa3d3de4616b5482400caaa6e55244 at 127.0.0.1:38150 failed: Connection refused
### Starting test Unable to find a replica to perform an auto failover - shutdown in tests/unit/cluster/auto-failover-on-shutdown.tcl
345:M 03 May 2025 23:06:25.003 - Accepted 127.0.0.1:52855
345:M 03 May 2025 23:06:25.011 * Clear FAIL state for node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 (): replica is reachable again.
345:M 03 May 2025 23:06:25.011 * Node 1d791bca193d96bbd9b289e87c3b2d49049bf8f8 () is now a replica of node 3f1fe177229b170047ebdd7c3cc22b813c6e2e16 () in shard 8b4aef7e44a56d7e7bc3679c4687aed086bec4ce
345:M 03 May 2025 23:06:25.012 * Replica 127.0.0.1:28147 asks for synchronization
345:M 03 May 2025 23:06:25.012 * Partial resynchronization request from 127.0.0.1:28147 accepted. Sending 0 bytes of backlog starting from offset 489.
345:M 03 May 2025 23:06:25.034 * Connection with replica 127.0.0.1:28147 lost.
345:M 03 May 2025 23:06:25.036 * User requested shutdown... (user request from 'id=3 addr=127.0.0.1:65197 laddr=127.0.0.1:28144 fd=14 name= user=default lib-name= lib-ver=')
345:M 03 May 2025 23:06:25.036 * Removing the pid file.
345:M 03 May 2025 23:06:25.036 * Unable to find a replica to perform the auto failover on shutdown.
345:M 03 May 2025 23:06:25.036 * Saving the cluster configuration file before exiting.
345:M 03 May 2025 23:06:25.043 * Removing the unix socket file.
345:M 03 May 2025 23:06:25.043 # Valkey is now ready to exit, bye bye...
### Starting test Check for memory leaks (pid 494) in tests/unit/cluster/auto-failover-on-shutdown.tcl
### Starting test Check for memory leaks (pid 470) in tests/unit/cluster/auto-failover-on-shutdown.tcl
### Starting test Check for memory leaks (pid 458) in tests/unit/cluster/auto-failover-on-shutdown.tcl
### Starting test Check for memory leaks (pid 425) in tests/unit/cluster/auto-failover-on-shutdown.tcl
### Starting test Check for memory leaks (pid 382) in tests/unit/cluster/auto-failover-on-shutdown.tcl

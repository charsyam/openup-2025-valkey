### Starting server for test 
3323:M 03 May 2025 23:06:26.620 * oO0OoO0OoO0Oo Valkey is starting oO0OoO0OoO0Oo
3323:M 03 May 2025 23:06:26.620 * Valkey version=255.255.255, bits=64, commit=06ac4d81, modified=0, pid=3323, just started
3323:M 03 May 2025 23:06:26.620 * Configuration loaded
3323:M 03 May 2025 23:06:26.621 * Increased maximum number of open files to 10032 (it was originally set to 256).
3323:M 03 May 2025 23:06:26.621 * monotonic clock: POSIX clock_gettime
3323:M 03 May 2025 23:06:26.621 # Failed to write PID file: Permission denied
                .+^+.                                                
            .+#########+.                                            
        .+########+########+.           Valkey 255.255.255 (06ac4d81/0) 64 bit
    .+########+'     '+########+.                                    
 .########+'     .+.     '+########.    Running in standalone mode
 |####+'     .+#######+.     '+####|    Port: 26163
 |###|   .+###############+.   |###|    PID: 3323                     
 |###|   |#####*'' ''*#####|   |###|                                 
 |###|   |####'  .-.  '####|   |###|                                 
 |###|   |###(  (@@@)  )###|   |###|          https://valkey.io      
 |###|   |####.  '-'  .####|   |###|                                 
 |###|   |#####*.   .*#####|   |###|                                 
 |###|   '+#####|   |#####+'   |###|                                 
 |####+.     +##|   |#+'     .+####|                                 
 '#######+   |##|        .+########'                                 
    '+###|   |##|    .+########+'                                    
        '|   |####+########+'                                        
             +#########+'                                            
                '+v+'                                                

3323:M 03 May 2025 23:06:26.621 # WARNING: The TCP backlog setting of 511 cannot be enforced because kern.ipc.somaxconn is set to the lower value of 128.
3323:M 03 May 2025 23:06:26.621 * Server initialized
3323:M 03 May 2025 23:06:26.621 * Ready to accept connections tcp
3323:M 03 May 2025 23:06:26.622 * Ready to accept connections unix
3323:M 03 May 2025 23:06:26.771 - Accepted 127.0.0.1:54180
3323:M 03 May 2025 23:06:26.771 - Client closed connection id=2 addr=127.0.0.1:54180 laddr=127.0.0.1:26163 fd=12 name= age=0 idle=0 flags=N capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=16384 rbp=16384 obl=0 oll=0 omem=0 tot-mem=33792 events=r cmd=ping user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=7 tot-net-out=7 tot-cmds=1
3323:M 03 May 2025 23:06:26.805 - Accepted 127.0.0.1:54198
### Starting test failover command fails without connected replica in tests/integration/failover.tcl
### Starting test setup replication for following tests in tests/integration/failover.tcl
3323:S 03 May 2025 23:06:26.865 * Before turning into a replica, using my own primary parameters to synthesize a cached primary: I may be able to synchronize with the new primary with just a partial transfer.
3323:S 03 May 2025 23:06:26.865 * Connecting to PRIMARY 127.0.0.1:26164
3323:S 03 May 2025 23:06:26.865 * PRIMARY <-> REPLICA sync started
3323:S 03 May 2025 23:06:26.865 * REPLICAOF 127.0.0.1:26164 enabled (user request from 'id=3 addr=127.0.0.1:54198 laddr=127.0.0.1:26163 fd=12 name= user=default lib-name= lib-ver=')
3323:S 03 May 2025 23:06:26.865 * Non blocking connect for SYNC fired the event.
3323:S 03 May 2025 23:06:26.865 * Primary replied to PING, replication can continue...
3323:S 03 May 2025 23:06:26.865 * Trying a partial resynchronization (request 52de504b17153e48c1a053ef7f464a61cf652263:1).
3323:S 03 May 2025 23:06:26.865 * Full resync from primary: 329a089b15a35410591548ae48706e096f23ccd9:0
3323:S 03 May 2025 23:06:26.867 * PRIMARY <-> REPLICA sync: receiving streamed RDB from primary with EOF to disk
3323:S 03 May 2025 23:06:26.871 * Discarding previously cached primary state.
3323:S 03 May 2025 23:06:26.871 * PRIMARY <-> REPLICA sync: Flushing old data
3323:S 03 May 2025 23:06:26.871 * PRIMARY <-> REPLICA sync: Loading DB in memory
3323:S 03 May 2025 23:06:26.871 * Loading RDB produced by Valkey version 255.255.255
3323:S 03 May 2025 23:06:26.871 * RDB age 0 seconds
3323:S 03 May 2025 23:06:26.871 * RDB memory usage when created 1.21 Mb
3323:S 03 May 2025 23:06:26.871 * Done loading RDB, keys loaded: 0, keys expired: 0.
3323:S 03 May 2025 23:06:26.871 * PRIMARY <-> REPLICA sync: Finished with success
### Starting test failover command fails with invalid host in tests/integration/failover.tcl
### Starting test failover command fails with invalid port in tests/integration/failover.tcl
### Starting test failover command fails with just force and timeout in tests/integration/failover.tcl
### Starting test failover command fails when sent to a replica in tests/integration/failover.tcl
### Starting test failover command fails with force without timeout in tests/integration/failover.tcl
### Starting test failover command to specific replica works in tests/integration/failover.tcl
3323:S 03 May 2025 23:06:27.718 - Accepted 127.0.0.1:54874
3323:S 03 May 2025 23:06:27.718 * Failover request received for replid 329a089b15a35410591548ae48706e096f23ccd9.
3323:M 03 May 2025 23:06:27.718 * Connection with primary lost.
3323:M 03 May 2025 23:06:27.718 * Caching the disconnected primary state.
3323:M 03 May 2025 23:06:27.718 * Discarding previously cached primary state.
3323:M 03 May 2025 23:06:27.718 * Setting secondary replication ID to 329a089b15a35410591548ae48706e096f23ccd9, valid up to offset: 362027. New replication ID is f83d9a30e0e224d77af5ab9656b74ab2e2a7e261
3323:M 03 May 2025 23:06:27.718 * PRIMARY MODE enabled (failover request from 'id=6 addr=127.0.0.1:54874 laddr=127.0.0.1:26163 fd=14 name= user=default lib-name= lib-ver=')
3323:M 03 May 2025 23:06:27.718 * Replica 127.0.0.1:26164 asks for synchronization
3323:M 03 May 2025 23:06:27.719 * Partial resynchronization request from 127.0.0.1:26164 accepted. Sending 0 bytes of backlog starting from offset 362027.
3323:M 03 May 2025 23:06:27.844 - Accepted 127.0.0.1:54955
3323:M 03 May 2025 23:06:27.844 * Replica 127.0.0.1:26162 asks for synchronization
3323:M 03 May 2025 23:06:27.844 * Partial resynchronization request from 127.0.0.1:26162 accepted. Sending 0 bytes of backlog starting from offset 362027.
### Starting test failover command to any replica works in tests/integration/failover.tcl
3323:M 03 May 2025 23:06:27.900 * FAILOVER requested to any replica.
3323:M 03 May 2025 23:06:28.564 * Failover target 127.0.0.1:26162 is synced, failing over.
3323:S 03 May 2025 23:06:28.564 * Before turning into a replica, using my own primary parameters to synthesize a cached primary: I may be able to synchronize with the new primary with just a partial transfer.
3323:S 03 May 2025 23:06:28.564 * Connecting to PRIMARY 127.0.0.1:26162
3323:S 03 May 2025 23:06:28.564 * PRIMARY <-> REPLICA sync started
3323:S 03 May 2025 23:06:28.564 * Non blocking connect for SYNC fired the event.
3323:S 03 May 2025 23:06:28.564 * Primary replied to PING, replication can continue...
3323:S 03 May 2025 23:06:28.564 * Trying a partial resynchronization (request f83d9a30e0e224d77af5ab9656b74ab2e2a7e261:362080).
3323:S 03 May 2025 23:06:28.564 - Client closed connection id=7 addr=127.0.0.1:54955 laddr=127.0.0.1:26163 fd=13 name= age=1 idle=0 flags=S capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=1024 rbp=0 obl=0 oll=1 omem=16920 tot-mem=35352 events=r cmd=replconf user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=285 tot-net-out=75 tot-cmds=6
3323:S 03 May 2025 23:06:28.564 * Connection with replica 127.0.0.1:26162 lost.
3323:S 03 May 2025 23:06:28.564 * Successful partial resynchronization with primary.
3323:S 03 May 2025 23:06:28.564 * Primary replication ID changed to 421a1fa9d758d8e38a40005183ebbd6cde02698f
3323:S 03 May 2025 23:06:28.564 * Connection with replica 127.0.0.1:26164 lost.
3323:S 03 May 2025 23:06:28.564 * PRIMARY <-> REPLICA sync: Primary accepted a Partial Resynchronization.
3323:S 03 May 2025 23:06:28.629 - Accepted 127.0.0.1:55475
3323:S 03 May 2025 23:06:28.629 - Reading from client: Connection reset by peer
### Starting test failover to a replica with force works in tests/integration/failover.tcl
3323:S 03 May 2025 23:06:29.036 - Client closed connection id=8 addr=127.0.0.1:26162 laddr=127.0.0.1:55416 fd=15 name= age=1 idle=1 flags=M capa= db=9 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=1024 rbp=39 obl=0 oll=0 omem=0 tot-mem=18432 events=r cmd=set user=(superuser) redir=-1 resp=2 lib-name= lib-ver= tot-net-in=53 tot-net-out=39 tot-cmds=2
3323:S 03 May 2025 23:06:29.036 * Connection with primary lost.
3323:S 03 May 2025 23:06:29.041 * Caching the disconnected primary state.
3323:S 03 May 2025 23:06:29.044 * Reconnecting to PRIMARY 127.0.0.1:26162
3323:S 03 May 2025 23:06:29.050 * PRIMARY <-> REPLICA sync started
3323:S 03 May 2025 23:06:29.053 * Non blocking connect for SYNC fired the event.
3323:S 03 May 2025 23:06:29.054 * Primary replied to PING, replication can continue...
3323:S 03 May 2025 23:06:29.057 * Trying a partial resynchronization (request 421a1fa9d758d8e38a40005183ebbd6cde02698f:362133).
3323:S 03 May 2025 23:06:29.060 * Successful partial resynchronization with primary.
3323:S 03 May 2025 23:06:29.064 * Primary replication ID changed to 0b3959483d4a2d2d89f5dfbdd6a8b401506ea7ec
3323:S 03 May 2025 23:06:29.067 * PRIMARY <-> REPLICA sync: Primary accepted a Partial Resynchronization.
3323:M 03 May 2025 23:06:29.124 * Connection with primary lost.
3323:M 03 May 2025 23:06:29.129 * Caching the disconnected primary state.
3323:S 03 May 2025 23:06:29.132 * Connecting to PRIMARY 127.0.0.1:26164
3323:S 03 May 2025 23:06:29.132 * PRIMARY <-> REPLICA sync started
3323:S 03 May 2025 23:06:29.132 * REPLICAOF 127.0.0.1:26164 enabled (user request from 'id=3 addr=127.0.0.1:54198 laddr=127.0.0.1:26163 fd=12 name= user=default lib-name= lib-ver=')
3323:S 03 May 2025 23:06:29.132 * Non blocking connect for SYNC fired the event.
3323:S 03 May 2025 23:06:29.138 * Primary replied to PING, replication can continue...
3323:S 03 May 2025 23:06:29.141 * Trying a partial resynchronization (request 0b3959483d4a2d2d89f5dfbdd6a8b401506ea7ec:362133).
3323:S 03 May 2025 23:06:29.142 * Successful partial resynchronization with primary.
3323:S 03 May 2025 23:06:29.142 * PRIMARY <-> REPLICA sync: Primary accepted a Partial Resynchronization.
### Starting test failover with timeout aborts if replica never catches up in tests/integration/failover.tcl
### Starting test failovers can be aborted in tests/integration/failover.tcl
### Starting test failover aborts if target rejects sync request in tests/integration/failover.tcl
3323:S 03 May 2025 23:06:30.260 - Accepted 127.0.0.1:56679
3323:S 03 May 2025 23:06:30.261 - Client closed connection id=10 addr=127.0.0.1:56679 laddr=127.0.0.1:26163 fd=14 name= age=0 idle=0 flags=N capa= db=0 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=16384 rbp=16384 obl=0 oll=0 omem=0 tot-mem=33792 events=r cmd=psync user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=260 tot-net-out=90 tot-cmds=4
3323:S 03 May 2025 23:06:30.261 - Client closed connection id=8 addr=127.0.0.1:26164 laddr=127.0.0.1:55871 fd=13 name= age=2 idle=0 flags=M capa= db=9 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=1024 rbp=39 obl=0 oll=0 omem=0 tot-mem=18432 events=r cmd=set user=(superuser) redir=-1 resp=2 lib-name= lib-ver= tot-net-in=167 tot-net-out=78 tot-cmds=6
3323:S 03 May 2025 23:06:30.261 * Connection with primary lost.
3323:S 03 May 2025 23:06:30.261 * Caching the disconnected primary state.
3323:S 03 May 2025 23:06:30.261 * Reconnecting to PRIMARY 127.0.0.1:26164
3323:S 03 May 2025 23:06:30.261 * PRIMARY <-> REPLICA sync started
3323:S 03 May 2025 23:06:30.261 * Non blocking connect for SYNC fired the event.
3323:S 03 May 2025 23:06:30.261 * Primary replied to PING, replication can continue...
3323:S 03 May 2025 23:06:30.261 * Trying a partial resynchronization (request 0b3959483d4a2d2d89f5dfbdd6a8b401506ea7ec:362247).
3323:S 03 May 2025 23:06:30.261 * Successful partial resynchronization with primary.
3323:S 03 May 2025 23:06:30.261 * Primary replication ID changed to 9ae7835739d01d602dc3ddc1c80965cc65a4e315
3323:S 03 May 2025 23:06:30.261 * PRIMARY <-> REPLICA sync: Primary accepted a Partial Resynchronization.
### Starting test Check for memory leaks (pid 3382) in tests/integration/failover.tcl
3323:S 03 May 2025 23:06:32.281 - DB 9: 5699 keys (0 volatile) in 7168 slots HT.
3323:S 03 May 2025 23:06:34.354 - Client closed connection id=8 addr=127.0.0.1:26164 laddr=127.0.0.1:56682 fd=13 name= age=6 idle=4 flags=M capa= db=9 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=65530 argv-mem=0 multi-mem=0 rbs=1024 rbp=39 obl=0 oll=0 omem=0 tot-mem=67072 events=r cmd=set user=(superuser) redir=-1 resp=2 lib-name= lib-ver= tot-net-in=167 tot-net-out=234 tot-cmds=6
3323:S 03 May 2025 23:06:34.354 * Connection with primary lost.
3323:S 03 May 2025 23:06:34.354 * Caching the disconnected primary state.
3323:S 03 May 2025 23:06:34.354 * Reconnecting to PRIMARY 127.0.0.1:26164
3323:S 03 May 2025 23:06:34.354 * PRIMARY <-> REPLICA sync started
3323:S 03 May 2025 23:06:34.354 # Error condition on socket for SYNC: Connection refused
3323:S 03 May 2025 23:06:34.412 - Client closed connection id=3 addr=127.0.0.1:54198 laddr=127.0.0.1:26163 fd=12 name= age=8 idle=4 flags=N capa= db=9 sub=0 psub=0 ssub=0 multi=-1 watch=0 qbuf=0 qbuf-free=16890 argv-mem=0 multi-mem=0 rbs=1024 rbp=0 obl=0 oll=0 omem=0 tot-mem=18432 events=r cmd=debug user=default redir=-1 resp=2 lib-name= lib-ver= tot-net-in=1045 tot-net-out=138869 tot-cmds=49
3323:signal-handler (1746281196) Received SIGTERM scheduling shutdown...
3323:S 03 May 2025 23:06:36.240 * User requested shutdown...
3323:S 03 May 2025 23:06:36.240 * Removing the pid file.
3323:S 03 May 2025 23:06:36.240 * Removing the unix socket file.
3323:S 03 May 2025 23:06:36.240 # Valkey is now ready to exit, bye bye...
